# <a name="upload-files-sample-app"></a><span data-ttu-id="b037f-101">Beispiel-App zum Hochladen von Dateien</span><span class="sxs-lookup"><span data-stu-id="b037f-101">Upload Files Sample App</span></span>

<span data-ttu-id="b037f-102">Diese Beispiel-App veranschaulicht die im Thema [Hochladen von Dateien in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads) beschriebenen Konzepte.</span><span class="sxs-lookup"><span data-stu-id="b037f-102">This sample app demonstrates concepts described in the [Upload files in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads) topic.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="b037f-103">Sicherheitsüberlegungen</span><span class="sxs-lookup"><span data-stu-id="b037f-103">Security considerations</span></span>

<span data-ttu-id="b037f-104">Gehen Sie mit Bedacht vor, wenn Sie Benutzern die Möglichkeit geben, Dateien auf einen Server hochzuladen.</span><span class="sxs-lookup"><span data-stu-id="b037f-104">Use caution when providing users with the ability to upload files to a server.</span></span> <span data-ttu-id="b037f-105">Angreifer können [Denial-of-Service](/windows-hardware/drivers/ifs/denial-of-service)-Angriffe ausführen, Viren oder Schadsoftware hochladen oder versuchen, Netzwerke und Server auf andere Weise zu kompromittieren.</span><span class="sxs-lookup"><span data-stu-id="b037f-105">Attackers may execute [denial of service](/windows-hardware/drivers/ifs/denial-of-service) attacks, attempt to upload viruses or malware, or attempt to compromise networks and servers in other ways.</span></span>

<span data-ttu-id="b037f-106">Folgende Schritte können Sie dabei unterstützen, die Wahrscheinlichkeit eines erfolgreichen Angriffs zu verringern:</span><span class="sxs-lookup"><span data-stu-id="b037f-106">Security steps that reduce the likelihood of a successful attack are:</span></span>

* <span data-ttu-id="b037f-107">Laden Sie Dateien in einen dedizierten Bereich zum Hochladen von Dateien auf dem System hoch, vorzugsweise auf ein Nicht-Systemlaufwerk.</span><span class="sxs-lookup"><span data-stu-id="b037f-107">Upload files to a dedicated file upload area on the system, preferably to a non-system drive.</span></span> <span data-ttu-id="b037f-108">Die Verwendung eines dedizierten Speicherorts erleichtert es, Sicherheitsmaßnahmen für hochgeladene Dateien zu erzwingen.</span><span class="sxs-lookup"><span data-stu-id="b037f-108">Use of a dedicated location makes it easier to impose security measures on uploaded files.</span></span> <span data-ttu-id="b037f-109">Deaktivieren Sie Ausführungsberechtigungen für den Speicherort zum Hochladen Dateien.&dagger;</span><span class="sxs-lookup"><span data-stu-id="b037f-109">Disable execute permissions on the file upload location.&dagger;</span></span>
* <span data-ttu-id="b037f-110">Hochgeladene Dateien dürfen nie persistent in der Verzeichnisstruktur gespeichert werden, in der sich auch die App befindet.&dagger;</span><span class="sxs-lookup"><span data-stu-id="b037f-110">Never persist uploaded files in the same directory tree as the app.&dagger;</span></span>
* <span data-ttu-id="b037f-111">Wählen Sie einen sicheren von der App festgelegten Dateinamen.</span><span class="sxs-lookup"><span data-stu-id="b037f-111">Use a safe file name determined by the app.</span></span> <span data-ttu-id="b037f-112">Verwenden Sie keinen vom Benutzer eingegebenen Dateinamen oder den nicht vertrauenswürdigen Dateinamen der hochgeladenen Datei.&dagger;</span><span class="sxs-lookup"><span data-stu-id="b037f-112">Don't use a file name provided by user input or the untrusted file name of the uploaded file.&dagger;</span></span>
* <span data-ttu-id="b037f-113">Lassen Sie nur einen festgelegten Satz genehmigter Dateierweiterungen zu.&dagger;</span><span class="sxs-lookup"><span data-stu-id="b037f-113">Only allow a specific set of approved file extensions.&dagger;</span></span>
* <span data-ttu-id="b037f-114">Überprüfen Sie die Signatur des Dateiformats, um zu verhindern, dass ein Benutzer eine getarnte Datei hochlädt (z. B. eine *EXE*-Datei mit der Erweiterung *.txt*).&dagger;</span><span class="sxs-lookup"><span data-stu-id="b037f-114">Check the file format signature to prevent a user from uploading a masqueraded file (for example, uploading an *.exe* file with a *.txt* extension).&dagger;</span></span>
* <span data-ttu-id="b037f-115">Stellen Sie sicher, dass clientseitige Überprüfungen auch auf dem Server erfolgen.</span><span class="sxs-lookup"><span data-stu-id="b037f-115">Verify that client-side checks are also performed on the server.</span></span> <span data-ttu-id="b037f-116">Clientseitige Überprüfungen sind leicht zu umgehen.&dagger;</span><span class="sxs-lookup"><span data-stu-id="b037f-116">Client-side checks are easy to circumvent.&dagger;</span></span>
* <span data-ttu-id="b037f-117">Überprüfen Sie die Größe des Uploads, und verhindern Sie Uploads, die größer als erwartet sind.&dagger;</span><span class="sxs-lookup"><span data-stu-id="b037f-117">Check the size of the upload and prevent uploads that are larger than expected.&dagger;</span></span>
* <span data-ttu-id="b037f-118">Wenn Dateien nicht durch eine hochgeladene Datei mit demselben Namen überschrieben werden sollen, vergleichen Sie den Dateinamen mit der Datenbank oder dem physischen Speicher, bevor Sie die Datei hochladen.</span><span class="sxs-lookup"><span data-stu-id="b037f-118">When files shouldn't be overwritten by an uploaded file with the same name, check the file name against the database or physical storage before uploading the file.</span></span>
* <span data-ttu-id="b037f-119">**Wenden Sie auf die hochgeladenen Inhalte einen Scanner auf Viren und Schadsoftware an, ehe die Datei gespeichert wird.**</span><span class="sxs-lookup"><span data-stu-id="b037f-119">**Run a virus/malware scanner on uploaded content before the file is stored.**</span></span>

<span data-ttu-id="b037f-120">&dagger;Die Beispiel-App veranschaulicht einen Ansatz, der die Kriterien erfüllt.</span><span class="sxs-lookup"><span data-stu-id="b037f-120">&dagger;The sample app demonstrates an approach that meets the criteria.</span></span>

> [!WARNING]
> <span data-ttu-id="b037f-121">Das Hochladen von schädlichem Code auf ein System ist häufig der erste Schritt, um Code mit der folgenden Absicht auszuführen:</span><span class="sxs-lookup"><span data-stu-id="b037f-121">Uploading malicious code to a system is frequently the first step to executing code that can:</span></span>
>
> * <span data-ttu-id="b037f-122">Vollständige Übernahme eines Systems</span><span class="sxs-lookup"><span data-stu-id="b037f-122">Completely takeover a system.</span></span>
> * <span data-ttu-id="b037f-123">Überlasten eines System mit dem Ziel eines Systemausfalls.</span><span class="sxs-lookup"><span data-stu-id="b037f-123">Overload a system with the result that the system crashes.</span></span>
> * <span data-ttu-id="b037f-124">Kompromittieren von Benutzer- oder Systemdaten</span><span class="sxs-lookup"><span data-stu-id="b037f-124">Compromise user or system data.</span></span>
> * <span data-ttu-id="b037f-125">Anwenden von Graffiti auf eine öffentliche Benutzeroberfläche.</span><span class="sxs-lookup"><span data-stu-id="b037f-125">Apply graffiti to a public UI.</span></span>
>
> <span data-ttu-id="b037f-126">Wie Sie die Angriffsoberfläche beim Akzeptieren von Benutzerdateien reduzieren, erfahren Sie in den folgenden Artikeln:</span><span class="sxs-lookup"><span data-stu-id="b037f-126">For information on reducing the attack surface area when accepting files from users, see the following resources:</span></span>
>
> * [<span data-ttu-id="b037f-127">Unrestricted File Upload (Uneingeschränkter Dateiupload)</span><span class="sxs-lookup"><span data-stu-id="b037f-127">Unrestricted File Upload</span></span>](https://www.owasp.org/index.php/Unrestricted_File_Upload)
> * [<span data-ttu-id="b037f-128">Azure-Sicherheit: Sicherstellen, dass entsprechende Kontrollen erfolgen, wenn Dateien von Benutzern akzeptiert werden</span><span class="sxs-lookup"><span data-stu-id="b037f-128">Azure Security: Ensure appropriate controls are in place when accepting files from users</span></span>](/azure/security/azure-security-threat-modeling-tool-input-validation#controls-users)

<span data-ttu-id="b037f-129">Weitere Informationen finden Sie unter [Hochladen von Dateien in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads).</span><span class="sxs-lookup"><span data-stu-id="b037f-129">For additional information, see [Upload files in ASP.NET Core](https://docs.microsoft.com/aspnet/core/mvc/models/file-uploads).</span></span>

## <a name="how-to-use-the-sample"></a><span data-ttu-id="b037f-130">Verwendung dieses Beispiels</span><span class="sxs-lookup"><span data-stu-id="b037f-130">How to use the sample</span></span>

<span data-ttu-id="b037f-131">In der Datei *appsettings.json*:</span><span class="sxs-lookup"><span data-stu-id="b037f-131">In the *appsettings.json* file:</span></span>

1. <span data-ttu-id="b037f-132">Legen Sie den Pfad für gespeicherte Dateien fest (`StoredFilesPath`).</span><span class="sxs-lookup"><span data-stu-id="b037f-132">Set the path for stored files (`StoredFilesPath`).</span></span>

   * <span data-ttu-id="b037f-133">Die Beispiel-App legt den Wert auf `c:\\files` fest, was voraussetzt, dass ein Ordner mit dem Namen *files* im Stammverzeichnis von Laufwerk C: des Systems existiert.</span><span class="sxs-lookup"><span data-stu-id="b037f-133">The sample app sets the value to `c:\\files`, which assumes that a folder named *files* exists at the system's C: drive root.</span></span>
   * <span data-ttu-id="b037f-134">Der Pfad muss vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="b037f-134">The path must exist.</span></span> <span data-ttu-id="b037f-135">Erstellen Sie den Ordner *files* auf Laufwerk C: des Systems, oder legen Sie den Pfad auf einen geeigneten Speicherort fest.</span><span class="sxs-lookup"><span data-stu-id="b037f-135">Create a *files* folder on the system's C: drive or set the path to a suitable location.</span></span>
   * <span data-ttu-id="b037f-136">Der Prozess der App erfordert Lese-/Schreibberechtigungen für den Pfad.</span><span class="sxs-lookup"><span data-stu-id="b037f-136">The app's process requires read/write permissions to the path.</span></span>
   * <span data-ttu-id="b037f-137">**WICHTIG!**</span><span class="sxs-lookup"><span data-stu-id="b037f-137">**IMPORTANT!**</span></span> <span data-ttu-id="b037f-138">Deaktivieren Sie Ausführungsberechtigungen für alle Benutzer im Pfad.</span><span class="sxs-lookup"><span data-stu-id="b037f-138">Disable execute permissions for all users at the path.</span></span>

1. <span data-ttu-id="b037f-139">Legen Sie den Grenzwert für die Dateigröße (`FileSizeLimit`) in Byte fest.</span><span class="sxs-lookup"><span data-stu-id="b037f-139">Set the file size limit (`FileSizeLimit`) in bytes.</span></span> <span data-ttu-id="b037f-140">Der Standardwert `2097152` (2.097.152 Bytes) der Beispiel-App ermöglicht das Hochladen von Dateien einer Größe von bis zu 2 MB.</span><span class="sxs-lookup"><span data-stu-id="b037f-140">The sample app's default value of `2097152` (2,097,152 bytes) permits file uploads up to 2 MB.</span></span>
