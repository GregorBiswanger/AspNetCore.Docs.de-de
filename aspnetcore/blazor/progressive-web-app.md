---
title: Erstellen progressiver Webanwendungen mit der Blazor WebAssembly für ASP.NET Core
author: guardrex
description: Erfahren Sie, wie Sie Blazor-basierte progressive Webanwendungen (PWAs) erstellen. Dies sind Web-Apps, die mithilfe moderner Browserfeatures über das gleiche Verhalten wie Desktop-Apps verfügen.
monikerRange: '>= aspnetcore-3.1'
ms.author: riande
ms.custom: mvc
ms.date: 03/09/2020
no-loc:
- Blazor
- SignalR
uid: blazor/progressive-web-app
ms.openlocfilehash: f1c1ce50f20bf579e67e1d4eb02cc7d9d681e354
ms.sourcegitcommit: 98bcf5fe210931e3eb70f82fd675d8679b33f5d6
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/11/2020
ms.locfileid: "79083560"
---
# <a name="build-progressive-web-applications-with-aspnet-core-opno-locblazor-webassembly"></a><span data-ttu-id="9fd1e-103">Erstellen progressiver Webanwendungen mit der Blazor WebAssembly für ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="9fd1e-103">Build Progressive Web Applications with ASP.NET Core Blazor WebAssembly</span></span>

<span data-ttu-id="9fd1e-104">Von [Steve Sanderson](https://github.com/SteveSandersonMS)</span><span class="sxs-lookup"><span data-stu-id="9fd1e-104">By [Steve Sanderson](https://github.com/SteveSandersonMS)</span></span>

[!INCLUDE[](~/includes/blazorwasm-preview-notice.md)]

[!INCLUDE[](~/includes/blazorwasm-3.2-template-article-notice.md)]

<span data-ttu-id="9fd1e-105">Eine progressive Webanwendung (PWA) ist eine webbasierte Anwendung, die mithilfe moderner Browser-APIs und -Funktionen das gleiche Verhalten wie eine Desktopanwendung aufweist.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-105">A Progressive Web Application (PWA) is a web-based application that uses modern browser APIs and capabilities to behave like a desktop application.</span></span> <span data-ttu-id="9fd1e-106">Dabei kann es sich um die folgenden Funktionen handeln:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-106">These capabilities can include:</span></span>

* <span data-ttu-id="9fd1e-107">Die Fähigkeit, offline zu arbeiten, und sofortiges Laden, unabhängig von der Netzwerkgeschwindigkeit</span><span class="sxs-lookup"><span data-stu-id="9fd1e-107">Working offline and always loading instantly, independently of network speed</span></span>
* <span data-ttu-id="9fd1e-108">Ausführung in einem eigenen Anwendungsfenster statt lediglich in einem Browserfenster</span><span class="sxs-lookup"><span data-stu-id="9fd1e-108">Being able to run in its own application window, not just a browser window</span></span>
* <span data-ttu-id="9fd1e-109">Starten über das Startmenü, das Dock oder den Startbildschirm des Hostbetriebssystems</span><span class="sxs-lookup"><span data-stu-id="9fd1e-109">Being launched from the host operating system (OS) start menu, dock, or home screen</span></span>
* <span data-ttu-id="9fd1e-110">Empfangen von Pushbenachrichtigungen von einem Back-End-Server, auch wenn der Benutzer die Anwendung nicht verwendet</span><span class="sxs-lookup"><span data-stu-id="9fd1e-110">Receiving push notifications from a backend server, even while the user is not using the application</span></span>
* <span data-ttu-id="9fd1e-111">Automatisches Aktualisieren im Hintergrund</span><span class="sxs-lookup"><span data-stu-id="9fd1e-111">Automatically updating in the background</span></span>

<span data-ttu-id="9fd1e-112">Benutzer können die Anwendung zunächst wie jede andere Single-Page-Anwendung (Single-Page Application, SPA) im eigenen Webbrowser entdecken und verwenden und später im Betriebssystem installieren und Pushbenachrichtigungen aktivieren.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-112">A user might first discover and use the application within their web browser like any other single-page application (SPA), then later progress to installing it in their OS and enabling push notifications.</span></span> <span data-ttu-id="9fd1e-113">Daher wird für sie der Begriff *progressiv* verwendet.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-113">That's why we use the term *progressive*.</span></span>

<span data-ttu-id="9fd1e-114">Die Blazor WebAssembly ist eine auf Standards basierende clientseitige Webanwendungsplattform. Sie kann daher jede beliebige Browser-API verwenden, einschließlich der PWA-APIs, die für die oben aufgeführten Funktionen erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-114">Blazor WebAssembly is a true standards-based client-side web application platform, so it can use any browser API, including PWA APIs needed for the capabilities listed above.</span></span> <span data-ttu-id="9fd1e-115">Sie kann wie jede andere clientseitige Webtechnologie offline ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-115">It can work offline just like any other client-side web technology.</span></span>

## <a name="pwa-template"></a><span data-ttu-id="9fd1e-116">PWA-Vorlage</span><span class="sxs-lookup"><span data-stu-id="9fd1e-116">PWA template</span></span>

<span data-ttu-id="9fd1e-117">Wenn Sie eine neue Blazor WebAssembly-Anwendung erstellen, haben Sie die Möglichkeit, PWA-Features hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-117">When creating a new Blazor WebAssembly application, you are offered the option to add PWA features.</span></span> <span data-ttu-id="9fd1e-118">In Visual Studio ist für diese Option ein Kontrollkästchen im Dialogfeld für die Projekterstellung vorhanden:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-118">In Visual Studio, the option is given as a checkbox in the project creation dialog:</span></span>

![Bild](https://user-images.githubusercontent.com/1101362/76207411-a6b54200-61f5-11ea-9dfc-6acd87a91428.png)

<span data-ttu-id="9fd1e-120">Wenn Sie das Projekt in der Befehlszeile erstellen, können Sie das `--pwa`-Flag verwenden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-120">If you're creating the project on the command line, you can use the `--pwa` flag.</span></span> <span data-ttu-id="9fd1e-121">Ein auf ein Objekt angewendeter</span><span class="sxs-lookup"><span data-stu-id="9fd1e-121">For example,</span></span>

```dotnetcli
dotnet new blazorwasm --pwa -o MyNewProject
```

<span data-ttu-id="9fd1e-122">In beiden Fällen können Sie diese Option bei Bedarf mit der Option „Von ASP.NET Core gehostet“ kombinieren.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-122">In both cases, you're free to combine this with the "ASP.NET Core hosted" option if you wish, but don't have to do so.</span></span> <span data-ttu-id="9fd1e-123">PWA-Features sind unabhängig vom Hostingmodell.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-123">PWA features are independent of the hosting model.</span></span>

## <a name="installation-and-app-manifest"></a><span data-ttu-id="9fd1e-124">Installation und App-Manifest</span><span class="sxs-lookup"><span data-stu-id="9fd1e-124">Installation and app manifest</span></span>

<span data-ttu-id="9fd1e-125">Wenn Benutzer eine Anwendung aufrufen, die mithilfe der PWA-Vorlagenoption erstellt wurde, können sie die Anwendung im Startmenü, Dock oder Startbildschirm des Betriebssystems installieren.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-125">When visiting an application created using the PWA template option, users have the option to install the application into their OS's start menu, dock, or home screen.</span></span>

<span data-ttu-id="9fd1e-126">Die Darstellung dieser Option hängt vom Browser des Benutzers ab.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-126">The way this option is presented depends on the user's browser.</span></span> <span data-ttu-id="9fd1e-127">Wenn z. B. Chromium-basierte Desktopbrowser wie Edge oder Chrome verwendet werden, wird in der URL-Leiste eine Schaltfläche zum *Hinzufügen* angezeigt:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-127">For example, when using desktop Chromium-based browsers such as Edge or Chrome, an *Add* button appears within the URL bar:</span></span>

![Bild](https://user-images.githubusercontent.com/1101362/76208127-f7796a80-61f6-11ea-8aea-7fba704be787.png)

<span data-ttu-id="9fd1e-129">Unter iOS können Besucher die PWA mithilfe der Schaltfläche *Teilen* von Safari und der zugehörigen Option *Zum Home-Bildschirm* installieren.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-129">On iOS, visitors can install the PWA using Safari's *Share* button and its *Add to Homescreen* option.</span></span> <span data-ttu-id="9fd1e-130">In Chrome für Android sollten Benutzer auf die Schaltfläche *Menü* in der oberen rechten Ecke tippen und dann *Zum Startbildschirm hinzufügen* auswählen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-130">On Chrome for Android, users should tap the *Menu* button in the upper-right corner, then choose *Add to Home screen*.</span></span>

<span data-ttu-id="9fd1e-131">Nach der Installation wird die Anwendung in einem eigenen Fenster ohne Adressleiste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-131">Once installed, the application appears in its own window, without any address bar.</span></span>

![Bild](https://user-images.githubusercontent.com/1101362/76208588-e2e9a200-61f7-11ea-85e1-8c3fc849b252.png)

<span data-ttu-id="9fd1e-133">Informationen zum Anpassen des Titels, des Farbschemas, des Symbols oder anderer Details des Fensters finden Sie in der Datei `manifest.json` im Verzeichnis *wwwroot* des Projekts.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-133">To customize the window's title, color scheme, icon, or other details, see the file `manifest.json` in your project's *wwwroot* directory.</span></span> <span data-ttu-id="9fd1e-134">Das Schema dieser Datei wird durch Webstandards definiert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-134">The schema of this file is defined by web standards.</span></span> <span data-ttu-id="9fd1e-135">Eine ausführliche Dokumentation finden Sie unter https://developer.mozilla.org/docs/Web/Manifest.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-135">For detailed documentation, see https://developer.mozilla.org/docs/Web/Manifest.</span></span>

## <a name="offline-support"></a><span data-ttu-id="9fd1e-136">Offlineunterstützung</span><span class="sxs-lookup"><span data-stu-id="9fd1e-136">Offline support</span></span>

<span data-ttu-id="9fd1e-137">Die Offlineausführung von Anwendungen, die mit der PWA-Vorlagenoption erstellt wurden, wird standardmäßig unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-137">By default, applications created using the PWA template option have support for running offline.</span></span> <span data-ttu-id="9fd1e-138">Der Benutzer muss zunächst die Anwendung öffnen, während er offline ist. Anschließend werden alle Ressourcen, die für die Offlineausführung erforderlich sind, automatisch vom Browser heruntergeladen und zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-138">A user must first visit the application while they are online, then the browser will automatically download and cache all the resources needed to operate offline.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9fd1e-139">Die Offlineunterstützung ist nur für *veröffentlichte* Anwendungen aktiviert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-139">Offline support is only enabled for *published* applications.</span></span> <span data-ttu-id="9fd1e-140">Während der Entwicklung ist sie nicht aktiviert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-140">It is not enabled during development.</span></span> <span data-ttu-id="9fd1e-141">Der Grund dafür ist, dass die Offlineausführung den üblichen Entwicklungszyklus, der das Vornehmen und Testen von Änderungen umfasst, beeinträchtigen würde.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-141">This is because it would interfere with the usual development cycle of making changes and testing them.</span></span>

> [!WARNING]
> <span data-ttu-id="9fd1e-142">Wenn Sie eine offlinefähige PWA liefern möchten, müssen Sie [einige wichtige Warnungen und Einschränkungen](#caveats-for-offline-pwas) beachten.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-142">If you intend to ship an offline-enabled PWA, there are [several important warnings and caveats](#caveats-for-offline-pwas) you need to understand.</span></span> <span data-ttu-id="9fd1e-143">Diese gelten allgemein für Offline-PWAs und sind nicht auf Blazor beschränkt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-143">These are inherent to offline PWAs, and not specific to Blazor.</span></span> <span data-ttu-id="9fd1e-144">Sie müssen diese Einschränkungen lesen und verstehen, bevor Sie Vermutungen über die Funktionsweise der offlinefähigen Anwendung anstellen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-144">Be sure to read and understand these caveats before making assumptions about how your offline-enabled application will work.</span></span>

<span data-ttu-id="9fd1e-145">Um die Funktionsweise der Offlineunterstützung zu ermitteln, [veröffentlichen Sie zunächst die Anwendung](https://docs.microsoft.com/aspnet/core/host-and-deploy/blazor/?view=aspnetcore-3.1&tabs=visual-studio#publish-the-app), und hosten Sie sie auf einem Server, der HTTPS unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-145">To see how offline support works, first [publish your application](https://docs.microsoft.com/aspnet/core/host-and-deploy/blazor/?view=aspnetcore-3.1&tabs=visual-studio#publish-the-app), and host it on a server supporting HTTPS.</span></span> <span data-ttu-id="9fd1e-146">Wenn Sie die Anwendung besuchen, können Sie die Entwicklertools des Browsers öffnen und überprüfen, ob ein *Service Worker* für den Host registriert ist:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-146">When you visit the application, you should be able to open the browser's dev tools and verify that a *Service Worker* is registered for your host:</span></span>

![Bild](https://user-images.githubusercontent.com/1101362/76210294-bd5e9780-61fb-11ea-9869-65c55c62803d.png)

<span data-ttu-id="9fd1e-148">Wenn Sie die Seite erneut laden, können Sie zudem auf der Registerkarte *Netzwerk* erkennen, dass alle zum Laden der Seite erforderlichen Ressourcen aus dem *Service Worker* oder *Cache* abgerufen werden:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-148">Additionally, if you reload the page, then on the *Network* tab you should see that all resources needed to load your page are being retrieved from the *Service Worker* or *Memory Cache*:</span></span>

![Bild](https://user-images.githubusercontent.com/1101362/76210472-1d553e00-61fc-11ea-84c6-291644df709e.png)

<span data-ttu-id="9fd1e-150">Daraus geht hervor, dass zum Laden der Anwendung durch den Browser kein Netzwerkzugriff erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-150">This shows that the browser is not dependent on network access to load your application.</span></span> <span data-ttu-id="9fd1e-151">Um dies zu überprüfen, können Sie entweder den Webserver herunterfahren oder den Browser anweisen, den Offlinemodus zu simulieren:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-151">To verify this, you can either shut down your web server, or instruct the browser to simulate offline mode:</span></span>

![Bild](https://user-images.githubusercontent.com/1101362/76210556-47a6fb80-61fc-11ea-9d12-20a8f6528744.png)

<span data-ttu-id="9fd1e-153">Sie können die Seite jetzt auch ohne Zugriff auf den Webserver erneut laden und erkennen, dass die Anwendung weiterhin geladen und ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-153">Now, even without access to your web server, you should be able to reload the page and see that your application still loads and runs.</span></span> <span data-ttu-id="9fd1e-154">Auch wenn Sie eine sehr langsame Netzwerkverbindung simulieren, wird die Seite trotzdem sofort geladen, da sie unabhängig vom Netzwerk geladen wird.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-154">Likewise, even if you simulate a very slow network connection, your page will still load immediately since it is loaded independently of the network.</span></span>

### <a name="service-worker"></a><span data-ttu-id="9fd1e-155">Service Worker</span><span class="sxs-lookup"><span data-stu-id="9fd1e-155">Service worker</span></span>

<span data-ttu-id="9fd1e-156">Die Offlineunterstützung erfolgt mit einem Service Worker.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-156">Offline support is achieved using a service worker.</span></span> <span data-ttu-id="9fd1e-157">Dies ist ein Webstandard, der nicht auf Blazor beschränkt ist.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-157">This is a web standard, not specific to Blazor.</span></span> <span data-ttu-id="9fd1e-158">Eine Dokumentation zu Service Workers finden Sie unter https://developer.mozilla.org/docs/Web/API/Service_Worker_API.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-158">For documentation about service workers, see https://developer.mozilla.org/docs/Web/API/Service_Worker_API.</span></span> <span data-ttu-id="9fd1e-159">Weitere Informationen zu häufigen Verwendungsmustern für Service Worker finden Sie im Artikel [The Service Worker Lifecycle](https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle) (Der Lebenszyklus der Service Worker, in englischer Sprache).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-159">To learn more about common usage patterns for service workers, see the excellent article [The Service Worker Lifecycle](https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle).</span></span>

<span data-ttu-id="9fd1e-160">Die PWA-Vorlage von Blazor erzeugt zwei Service-Worker-Dateien:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-160">Blazor's PWA template produces two service worker files:</span></span>

* <span data-ttu-id="9fd1e-161">*wwwroot/service-worker.js*; diese wird während der Entwicklung verwendet.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-161">*wwwroot/service-worker.js*, which is used during development</span></span>
* <span data-ttu-id="9fd1e-162">*wwwroot/service-worker.published.js*; diese wird nach dem Veröffentlichen der Anwendung verwendet.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-162">*wwwroot/service-worker.published.js*, which is used once your application is published</span></span>

<span data-ttu-id="9fd1e-163">Wenn Sie die Logik für diesen beiden Dateien gemeinsam nutzen möchten, können Sie eine dritte JavaScript-Datei hinzufügen, in der die gemeinsame Logik enthalten ist, und mithilfe von [`self.importScripts`](https://developer.mozilla.org/docs/Web/API/WorkerGlobalScope/importScripts) diese Logik in beide Dateien laden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-163">If you want to share logic between these two files, consider adding a third JavaScript file to hold the common logic, and use [`self.importScripts`](https://developer.mozilla.org/docs/Web/API/WorkerGlobalScope/importScripts) to load that logic into both files.</span></span>

#### <a name="cache-first-fetch-strategy"></a><span data-ttu-id="9fd1e-164">Cache-First-Abrufstrategie</span><span class="sxs-lookup"><span data-stu-id="9fd1e-164">Cache-first fetch strategy</span></span>

<span data-ttu-id="9fd1e-165">Der integrierte Service Worker *service-worker.published.js* löst Anforderungen mit einer *Cache-First*-Strategie auf.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-165">The built-in *service-worker.published.js* service worker resolves requests using a *cache-first* strategy.</span></span> <span data-ttu-id="9fd1e-166">Dies bedeutet, dass er immer zwischengespeicherte Inhalte zurückgibt, sofern verfügbar, unabhängig davon, ob der Benutzer über Netzwerkzugriff verfügt oder auf dem Server neuere Inhalte verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-166">This means it always prefers to return cached content if available, regardless of whether the user has network access or whether newer content is available on the server.</span></span>

<span data-ttu-id="9fd1e-167">Dies ist aus zwei Gründen vorteilhaft:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-167">There are two reasons why this is valuable:</span></span>

* <span data-ttu-id="9fd1e-168">**Die Zuverlässigkeit wird sichergestellt.**</span><span class="sxs-lookup"><span data-stu-id="9fd1e-168">**It ensures reliability.**</span></span> <span data-ttu-id="9fd1e-169">Der Netzwerkzugriff ist kein boolescher Zustand.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-169">Network access is not a boolean state.</span></span> <span data-ttu-id="9fd1e-170">Ein Benutzer ist nicht einfach online oder offline.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-170">A user is not simply "online" or "offline".</span></span> <span data-ttu-id="9fd1e-171">In der Praxis wird auf dem Gerät des Benutzers möglicherweise angezeigt, dass es online ist, die Netzwerkverbindung ist jedoch eventuell so langsam, dass sie nicht zu verwenden ist.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-171">In reality, the user's device may believe it is online, but the network may be so slow as to be impractical to wait for.</span></span> <span data-ttu-id="9fd1e-172">Oder das Netzwerk gibt möglicherweise für bestimmte URLs ungültige Ergebnisse zurück, z. B. wenn ein Captive-WLAN-Portal derzeit bestimmte Anforderungen blockiert oder umleitet.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-172">Or the network might be returning invalid results for certain URLs, such as when there is a captive WIFI portal that is currently blocking or redirecting certain requests.</span></span> <span data-ttu-id="9fd1e-173">Aus diesem Grund ist die `navigator.onLine`-API des Browsers nicht zuverlässig, und Sie sollten nicht auf sie vertrauen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-173">This is why the browser's `navigator.onLine` API is not reliable and should not be depended upon.</span></span>
* <span data-ttu-id="9fd1e-174">**Die Richtigkeit wird sichergestellt.**</span><span class="sxs-lookup"><span data-stu-id="9fd1e-174">**It ensures correctness.**</span></span> <span data-ttu-id="9fd1e-175">Beim Erstellen eines Caches für Offlineressourcen stellt der Service Worker mithilfe von Inhaltshashs sicher, dass er zu einem bestimmten Zeitpunkt eine vollständige und in sich konsistente Momentaufnahme der Ressourcen abgerufen hat.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-175">When building a cache of offline resources, the service worker uses content hashing to guarantee it has fetched a complete and self-consistent snapshot of resources at a single instant in time.</span></span> <span data-ttu-id="9fd1e-176">Dieser Cache wird dann als atomische Einheit verwendet.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-176">This cache is then used as an atomic unit.</span></span> <span data-ttu-id="9fd1e-177">Deshalb macht es keinen Sinn, vom Netzwerk neuere Ressourcen anzufordern, da Sie nur die Versionen wünschen, die bereits zwischengespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-177">Given this, there is no point asking the network for newer resources, since the only versions you want are the ones you've already cached.</span></span> <span data-ttu-id="9fd1e-178">Alle anderen Strategien sind mit dem Risiko von Inkonsistenz und Inkompatibilität behaftet (wenn z. B. versucht wird, Versionen von .NET-Assemblys zu verwenden, die nicht gemeinsam kompiliert wurden).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-178">Anything else risks inconsistency and incompatibility (for example, trying to use versions of .NET assemblies that were not compiled together).</span></span>

#### <a name="background-updates"></a><span data-ttu-id="9fd1e-179">Hintergrundupdates</span><span class="sxs-lookup"><span data-stu-id="9fd1e-179">Background updates</span></span>

<span data-ttu-id="9fd1e-180">Sie können sich das Verhalten einer Offline-First-PWA wie das einer mobilen App vorstellen, die installiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-180">As a mental model, you can think of an offline-first PWA as behaving like an mobile app that can be installed.</span></span> <span data-ttu-id="9fd1e-181">Sie wird unabhängig von der Netzwerkkonnektivität immer sofort gestartet, die installierte Anwendungslogik stammt jedoch aus einer Zeitpunkt-Momentaufnahme, die möglicherweise nicht die neueste Version ist.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-181">It always starts up immediately regardless of network connectivity, but the installed application logic comes from a point-in-time snapshot that might not be the latest version.</span></span>

<span data-ttu-id="9fd1e-182">Mit der Blazor-PWA-Vorlage werden Anwendungen erstellt, die immer automatisch versuchen, sich im Hintergrund zu aktualisieren, wenn sie vom Benutzer besucht werden und eine funktionsfähige Netzwerkverbindung besteht.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-182">The Blazor PWA template produces applications that automatically try to update themselves in the background whenever the user visits and has a working network connection.</span></span> <span data-ttu-id="9fd1e-183">Dies geschieht auf folgende Weise:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-183">The way this works is as follows:</span></span>

* <span data-ttu-id="9fd1e-184">Das Projekt generiert während der Kompilierung ein *Service-Worker-Assetmanifest*.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-184">During compilation, your project generates a *service worker assets manifest*.</span></span> <span data-ttu-id="9fd1e-185">Sein Standardname lautet *service-worker-assets.js*.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-185">By default this is called *service-worker-assets.js*.</span></span> <span data-ttu-id="9fd1e-186">In ihm werden alle statischen Ressourcen aufgelistet, die von der Anwendung für die Offlineausführung benötigt werden, z. B. .NET-Assemblys, JavaScript-Dateien, CSS usw., einschließlich ihrer Inhaltshashs.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-186">This lists all the static resources your application needs to function offline, such as .NET assemblies, JavaScript files, CSS, etc., including their content hashes.</span></span> <span data-ttu-id="9fd1e-187">Diese Liste wird vom Service Worker geladen, damit er weiß, welche Ressourcen zwischengespeichert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-187">This list is loaded by your service worker so that it knows which resources to cache.</span></span>
* <span data-ttu-id="9fd1e-188">Jedes Mal, wenn der Benutzer die Anwendung besucht, fordert der Browser *service-worker.js* und *service-worker-assets.js* im Hintergrund erneut an.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-188">Each time the user visits your application, the browser re-requests *service-worker.js* and *service-worker-assets.js* in the background.</span></span> <span data-ttu-id="9fd1e-189">Wenn der Server geänderte Inhalte für eine dieser Dateien zurückgibt (die Byte für Byte mit dem vorhandenen installierten Service Worker verglichen wurden), versucht der Service Worker, eine neue Version von sich selbst zu installieren.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-189">If the server returns changed content for either of these files (compared byte-for-byte with the existing installed service worker), the service worker tries to install a new version of itself.</span></span>
* <span data-ttu-id="9fd1e-190">Wenn der Service Worker eine neue Version von sich selbst installiert, erstellt er einen neuen, eigenen Cache für Offlineressourcen und füllt ihn mit Ressourcen auf, die in *service-worker-Assets.js* aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-190">When installing a new version of itself, the service worker creates a new, separate cache for offline resources, and starts populating it with resources listed in *service-worker-assets.js*.</span></span> <span data-ttu-id="9fd1e-191">Diese Logik ist in der Funktion `onInstall` in *service-worker.published.js* implementiert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-191">This logic is implemented in the `onInstall` function inside *service-worker.published.js*.</span></span>
* <span data-ttu-id="9fd1e-192">Wenn der Prozess erfolgreich abgeschlossen wird (d. h., alle Ressourcen werden ohne Fehler geladen, und alle Inhaltshashs stimmen überein), wechselt der neue Service Worker in den Status „Warten auf Aktivierung“.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-192">If the process completes successfully (i.e., all the resources are loaded without error, and all content hashes match), then the new service worker enters a "waiting for activation" state.</span></span> <span data-ttu-id="9fd1e-193">Sobald der Benutzer die Anwendung schließt (d. h., es sind keine Registerkarten oder Fenster mehr vorhanden, in denen die Anwendung angezeigt wird), wird der neue Service Worker aktiviert und für nachfolgende Besuche der Anwendung verwendet.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-193">As soon as the user closes your application (i.e., there are no remaining tabs or windows displaying your application), the new service worker becomes "active" and will be used for subsequent visits to your application.</span></span> <span data-ttu-id="9fd1e-194">Der alte Service Worker und der zugehörige Cache werden gelöscht.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-194">The old service worker and its cache are deleted.</span></span>
* <span data-ttu-id="9fd1e-195">Wenn der Prozess nicht erfolgreich abgeschlossen wird, wird die neue Service-Worker-Instanz verworfen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-195">If the process does not complete successfully, the new service worker instance is discarded.</span></span> <span data-ttu-id="9fd1e-196">Die Durchführung des Updates wird beim nächsten Besuch des Benutzers erneut versucht, und wenn eine bessere Netzwerkverbindung besteht, können die Anforderungen abgeschlossen kann.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-196">The update process will be attempted again on the user's next visit, when hopefully they have a better network connection that can complete the requests.</span></span>

<span data-ttu-id="9fd1e-197">Sie können jeden Aspekt dieses Prozesses anpassen, indem Sie die Service-Worker-Logik bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-197">You can customize any aspect of this process by editing the service worker logic.</span></span> <span data-ttu-id="9fd1e-198">Keine der obigen Erläuterungen ist auf Blazor beschränkt. Es handelt sich lediglich um eine empfohlene Vorgehensweise bei Verwendung der PWA-Vorlagenoption.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-198">None of the above is specific to Blazor, but is merely a suggestion provided by the PWA template option.</span></span> <span data-ttu-id="9fd1e-199">Weitere Informationen finden Sie in der [Service-Worker-Dokumentation](https://developer.mozilla.org/docs/Web/API/Service_Worker_API.).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-199">See [service worker documentation](https://developer.mozilla.org/docs/Web/API/Service_Worker_API.) for more information.</span></span>

#### <a name="how-requests-are-resolved"></a><span data-ttu-id="9fd1e-200">Auflösen von Anforderungen</span><span class="sxs-lookup"><span data-stu-id="9fd1e-200">How requests are resolved</span></span>

<span data-ttu-id="9fd1e-201">Wie oben beschrieben, verwendet der Standard-Service-Worker eine *Cache-First*-Strategie, d. h., er versucht, zwischengespeicherte Inhalte bereitzustellen, sofern verfügbar.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-201">As described above, the default service worker uses a *cache-first* strategy, meaning that it tries to serve cached content when available.</span></span> <span data-ttu-id="9fd1e-202">Wenn für eine bestimmte URL kein Inhalt zwischengespeichert ist, z. B. beim Anfordern von Daten aus einer Back-End-API, greift der Service Worker auf eine reguläre Netzwerkanforderung zurück, die nur erfolgreich ausgeführt werden kann, wenn der Server erreichbar ist.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-202">If there is no content cached for a certain URL, for example when requesting data from a backend API, the service worker falls back on a regular network request which can only succeed if the server is reachable.</span></span> <span data-ttu-id="9fd1e-203">Diese Logik ist in `onFetch` in *service-worker.published.js* implementiert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-203">This logic is implemented inside `onFetch` within *service-worker.published.js*.</span></span>

<span data-ttu-id="9fd1e-204">Wenn die Blazor-Komponenten Daten aus Back-End-APIs anfordern müssen und Sie ein benutzerfreundliches Verfahren für den Fall bereitstellen möchten, dass solche Anforderungen aufgrund der Nichtverfügbarkeit des Netzwerks fehlschlagen, müssen Sie die Logik in den Komponenten implementieren.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-204">If your Blazor components rely on requesting data from backend APIs, and you want to provide a friendly user experience in the case where such requests fail due to network unavailability, then you need to implement logic within your components.</span></span> <span data-ttu-id="9fd1e-205">Schließen Sie z. B. `HttpClient`-Anforderungen in `try/catch` ein.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-205">For example, use `try/catch` around `HttpClient` requests.</span></span>

#### <a name="support-server-rendered-pages"></a><span data-ttu-id="9fd1e-206">Unterstützung von auf dem Server gerenderten Seiten</span><span class="sxs-lookup"><span data-stu-id="9fd1e-206">Support server-rendered pages</span></span>

<span data-ttu-id="9fd1e-207">Überlegen Sie, was geschieht, wenn der Benutzer zum ersten Mal zu einer URL, z. B. `/counter`, oder zu einem anderen Deep-Link zu Ihrer Anwendung navigiert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-207">Consider what happens when the user first navigates to a URL such as `/counter` or any other deep link into your application.</span></span> <span data-ttu-id="9fd1e-208">In diesen Fällen sollen keine Inhalte zurückgegeben werden, die als `/counter` zwischengespeichert sind. Stattdessen muss der Browser als `/index.html` zwischengespeicherte Inhalte laden, um die Blazor WebAssembly-Anwendung zu starten.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-208">In these cases, you don't want to return content cached as `/counter`, but instead need the browser to load the content cached as `/index.html` to start up your Blazor WebAssembly application.</span></span> <span data-ttu-id="9fd1e-209">Diese anfänglichen Anforderungen werden als *Navigationsanforderungen* bezeichnet (im Gegensatz zu *Unterressourcenanforderungen* für Bilder/CSS/usw. oder *Fetch-/XHR-Anforderungen* für API-Daten).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-209">These initial requests are known as *navigation* requests (as opposed to *subresource* requests for images/CSS/etc, or *fetch/XHR* requests for API data).</span></span>

<span data-ttu-id="9fd1e-210">Der Standard-Service-Worker enthält eine spezielle Logik für Navigationsanforderungen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-210">The default service worker contains special-case logic for navigation requests.</span></span> <span data-ttu-id="9fd1e-211">Diese löst sie durch die Rückgabe des zwischengespeicherten Inhalts für `/index.html` auf, unabhängig von der angeforderten URL.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-211">It resolves them by returning the cached content for `/index.html`, regardless of the requested URL.</span></span> <span data-ttu-id="9fd1e-212">Diese Logik ist in der Funktion `onFetch` in *service-worker.published.js* implementiert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-212">This logic is implemented in the `onFetch` function inside *service-worker.published.js*.</span></span>

<span data-ttu-id="9fd1e-213">Wenn die Anwendung über bestimmte URLs verfügt, die auf dem Server gerendertes HTML zurückgeben müssen (ohne `/index.html` aus dem Cache bereitzustellen), müssen Sie die Logik im Service Worker bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-213">If your application has certain URLs that must return server-rendered HTML (and not serve `/index.html` from the cache), then you need to edit the logic in your service worker.</span></span> <span data-ttu-id="9fd1e-214">Wenn beispielsweise alle URLs, die `/Identity/` enthalten, als reguläre Onlineanforderungen an den Server behandelt werden müssen, ändern Sie die in *service-worker.published.js* `onFetch` vorhandene Logik.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-214">For example, if all URLs containing `/Identity/` need to be handled as regular online-only requests to the server, then modify *service-worker.published.js* `onFetch` logic.</span></span> <span data-ttu-id="9fd1e-215">Suchen Sie den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-215">Locate the following code:</span></span>

```javascript
const shouldServeIndexHtml = event.request.mode === 'navigate';
```

<span data-ttu-id="9fd1e-216">Ändern Sie den Code wie folgt:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-216">Change the code to the following:</span></span>

```javascript
const shouldServeIndexHtml = event.request.mode === 'navigate'
    && !event.request.url.includes('/Identity/');
```

<span data-ttu-id="9fd1e-217">Wenn Sie dies nicht tun, fängt der Service Worker unabhängig von der Netzwerkkonnektivität Anforderungen für diese URLs ab und löst sie mithilfe von `/index.html` auf.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-217">If you don't do this, then regardless of network connectivity, the service worker will intercept requests for such URLs and will resolve them using `/index.html`.</span></span>

#### <a name="control-asset-caching"></a><span data-ttu-id="9fd1e-218">Steuern der Zwischenspeicherung von Ressourcen</span><span class="sxs-lookup"><span data-stu-id="9fd1e-218">Control asset caching</span></span>

<span data-ttu-id="9fd1e-219">Wenn im Projekt eine MSBuild-Eigenschaft mit dem Namen `ServiceWorkerAssetsManifest` definiert ist, generieren die Buildtools von Blazor ein Service-Worker-Assetmanifest mit dem angegebenen Namen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-219">If your project defines an MSBuild property called `ServiceWorkerAssetsManifest`, then Blazor's build tooling will generate a service worker assets manifest with the specified name.</span></span> <span data-ttu-id="9fd1e-220">Die PWA-Standardvorlage erzeugt eine Projektdatei, die Folgendes enthält:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-220">The default PWA template produces a project file containing the following:</span></span>

```xml
<ServiceWorkerAssetsManifest>service-worker-assets.js</ServiceWorkerAssetsManifest>
```

<span data-ttu-id="9fd1e-221">Die Datei wird in das Ausgabeverzeichnis *wwwroot* eingefügt, sodass sie vom Browser durch Anfordern von `/service-worker-assets.js` abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-221">The file is placed in the *wwwroot* output directory, so the browser can retrieve this file by requesting `/service-worker-assets.js`.</span></span> <span data-ttu-id="9fd1e-222">Um die Inhalte anzuzeigen, öffnen Sie *YourProject\bin\Debug\netstandard2.1\wwwroot\service-worker-assets.js* in einem Text-Editor.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-222">To see the contents, open *YourProject\bin\Debug\netstandard2.1\wwwroot\service-worker-assets.js* in a text editor.</span></span> <span data-ttu-id="9fd1e-223">Bearbeiten Sie die Datei jedoch nicht, da sie bei jedem Build erneut generiert wird.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-223">However, don't edit the file, as it will be regenerated on each build.</span></span>

<span data-ttu-id="9fd1e-224">Standardmäßig wird in diesem Manifest Folgendes aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-224">By default, this manifest lists:</span></span>

* <span data-ttu-id="9fd1e-225">Alle von Blazor verwalteten Ressourcen, z. B. .NET-Assemblys und die .NET-WebAssembly-Laufzeitdateien, die offline ausgeführt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-225">Any Blazor-managed resources such as .NET assemblies and the .NET WebAssembly runtime files needed to function offline</span></span>
* <span data-ttu-id="9fd1e-226">Alle Ressourcen, die im Verzeichnis *wwwroot* veröffentlicht werden, z. B. Bilder, CSS-Dateien und JavaScript-Dateien.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-226">All resources that will be published in your *wwwroot* directory, such as images, CSS files, and JavaScript files.</span></span> <span data-ttu-id="9fd1e-227">Hierzu zählen auch statische Webressourcen, die von externen Projekten und NuGet-Paketen bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-227">This includes static web assets supplied by external projects and NuGet packages.</span></span>

<span data-ttu-id="9fd1e-228">Sie können steuern, welche dieser Ressourcen vom Service Worker abgerufen und zwischengespeichert werden, indem Sie die Logik in `onInstall` in *service-worker.published.js* bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-228">You can control which of these resources will be fetched and cached by the service worker by editing the logic in `onInstall` in *service-worker.published.js*.</span></span> <span data-ttu-id="9fd1e-229">Standardmäßig werden Dateien abgerufen und zwischengespeichert, die typische Webdateierweiterungen aufweisen, z. B. *.html*, *.css*, *.js*, *.wasm* u. a., sowie spezielle Dateitypen für die Blazor WebAssembly ( *.dll*, *.pdb*).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-229">By default, it will fetch and cache files matching typical web filename extensions such as *.html*, *.css*, *.js*, *.wasm*, and others, plus file types specific to Blazor WebAssembly (*.dll*, *.pdb*).</span></span>

<span data-ttu-id="9fd1e-230">Wenn Sie weitere Ressourcen einschließen möchten, die nicht im Verzeichnis *wwwroot* enthalten sind, können Sie zusätzliche MSBuild-ItemGroup-Einträge definieren.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-230">If you want to include additional resources that aren't present in your *wwwroot* directory, you can do so by defining extra MSBuild itemgroup entries.</span></span> <span data-ttu-id="9fd1e-231">Fügen Sie z. B. in der Projektdatei Folgendes hinzu:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-231">For example, in your project file, add:</span></span>

```xml
<ItemGroup>
    <ServiceWorkerAssetsManifestItem
        Include="MyDirectory\AnotherFile.json"
        RelativePath="MyDirectory\AnotherFile.json"
        AssetUrl="files/AnotherFile.json" />
</ItemGroup>
```

<span data-ttu-id="9fd1e-232">Die `AssetUrl`-Metadaten geben die zur Basis relative URL an, die der Browser beim Abrufen der zwischenzuspeichernden Ressource verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-232">The `AssetUrl` metadata specifies the base-relative URL that the browser should use when fetching the resource to cache.</span></span> <span data-ttu-id="9fd1e-233">Dieser Wert kann unabhängig vom ursprünglichen Quelldateinamen auf dem Datenträger sein.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-233">This can be independent of its original source file name on disk.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9fd1e-234">Das Hinzufügen eines `ServiceWorkerAssetsManifestItem` bewirkt nicht, dass die Datei im Verzeichnis *wwwroot* veröffentlicht wird.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-234">Adding a `ServiceWorkerAssetsManifestItem` does not cause the file to be published in your *wwwroot* directory.</span></span> <span data-ttu-id="9fd1e-235">Sie können die Veröffentlichungsausgabe separat steuern.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-235">It up to you to control your publish output separately.</span></span> <span data-ttu-id="9fd1e-236">Das `ServiceWorkerAssetsManifestItem` bewirkt lediglich, dass im Service-Worker-Assetmanifest ein zusätzlicher Eintrag angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-236">The `ServiceWorkerAssetsManifestItem` only causes an additional entry to appear in the service worker assets manifest.</span></span>

## <a name="push-notifications"></a><span data-ttu-id="9fd1e-237">Pushbenachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="9fd1e-237">Push notifications</span></span>

<span data-ttu-id="9fd1e-238">Eine Blazor WebAssembly-PWA kann wie jede andere PWA Pushbenachrichtigungen von einem Back-End-Server empfangen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-238">Like any other PWA, a Blazor WebAssembly PWA can receive push notifications from a backend server.</span></span> <span data-ttu-id="9fd1e-239">Der Server kann diese jederzeit senden, auch wenn der Benutzer die Anwendung nicht aktiv verwendet (wenn z. B. ein anderer Benutzer eine Aktion ausführt, die möglicherweise relevant ist).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-239">Your server can send these at any time, even when the user is not actively using your application (for example, when a different user performs an action that may be relevant).</span></span>

<span data-ttu-id="9fd1e-240">Der Mechanismus zum Senden einer Pushbenachrichtigung ist vollständig unabhängig von der Blazor WebAssembly, da er vom Back-End-Server implementiert wird, und dieser kann eine beliebige Technologie verwenden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-240">The mechanism for sending a push notification is entirely independent of Blazor WebAssembly, since it's implemented by the backend server which can use any technology.</span></span> <span data-ttu-id="9fd1e-241">Wenn Sie Pushbenachrichtigungen von einem ASP.NET Core-Server senden möchten, sollten Sie [ein ähnliches Verfahren wie das im Blazing Pizza-Workshop](https://github.com/dotnet-presentations/blazor-workshop/blob/master/docs/09-progressive-web-app.md#sending-push-notifications) verwenden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-241">If you want to send push notifications from an ASP.NET Core server, consider [using a technique similar to that in the Blazing Pizza workshop](https://github.com/dotnet-presentations/blazor-workshop/blob/master/docs/09-progressive-web-app.md#sending-push-notifications).</span></span>

<span data-ttu-id="9fd1e-242">Der Mechanismus zum Empfangen und Anzeigen einer Pushbenachrichtigung auf dem Client hängt auch von der Blazor WebAssembly ab, da er im Service Worker implementiert ist, bei dem es sich um eine JavaScript-Datei handelt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-242">The mechanism for receiving and displaying a push notification on the client is also independent of Blazor WebAssembly, since it's implemented in the service worker, which is a JavaScript file.</span></span> <span data-ttu-id="9fd1e-243">Ein Beispiel hierfür finden Sie in dem [im Blazing Pizza-Workshop verwendeten Verfahren](https://github.com/dotnet-presentations/blazor-workshop/blob/master/docs/09-progressive-web-app.md#displaying-notifications).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-243">As an example, you can again see [the approach used in the Blazing Pizza workshop](https://github.com/dotnet-presentations/blazor-workshop/blob/master/docs/09-progressive-web-app.md#displaying-notifications).</span></span>

## <a name="caveats-for-offline-pwas"></a><span data-ttu-id="9fd1e-244">Einschränkungen für Offline-PWAs</span><span class="sxs-lookup"><span data-stu-id="9fd1e-244">Caveats for offline PWAs</span></span>

<span data-ttu-id="9fd1e-245">Nicht alle Anwendungen sollten versuchen, die Offlineverwendung zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-245">Not all applications should attempt to support offline use.</span></span> <span data-ttu-id="9fd1e-246">Diese erhöht die Komplexität beträchtlich und ist nicht immer relevant.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-246">It adds significant complexity, while not always being relevant.</span></span>

<span data-ttu-id="9fd1e-247">Die Offlineunterstützung ist in der Regel nur in folgenden Situationen relevant:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-247">Offline support is usually relevant only:</span></span>

* <span data-ttu-id="9fd1e-248">Wenn der primäre Datenspeicher für den Browser lokal ist.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-248">If your primary data store is local to the browser.</span></span> <span data-ttu-id="9fd1e-249">Dies ist beispielsweise der Fall, wenn Sie eine Benutzeroberfläche für ein [IoT](https://en.wikipedia.org/wiki/Internet_of_things)-Gerät entwickeln, das Daten in `localStorage` oder [IndexedDB](https://developer.mozilla.org/docs/Web/API/IndexedDB_API) speichert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-249">For example, when building a UI for an [IoT](https://en.wikipedia.org/wiki/Internet_of_things) device that stores data in `localStorage` or [IndexedDB](https://developer.mozilla.org/docs/Web/API/IndexedDB_API).</span></span>

* <span data-ttu-id="9fd1e-250">Wenn Sie mit beträchtlichem Aufwand die Back-End-API-Daten abrufen und zwischenspeichern, die für die einzelnen Benutzer relevant sind, damit sie offline in ihnen navigieren können.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-250">If you do significant work to fetch and cache the backend API data relevant to each user, so they can navigate through it offline.</span></span> <span data-ttu-id="9fd1e-251">Wenn Sie die Bearbeitung unterstützen, müssen Sie auch ein System zum Nachverfolgen von Änderungen und Synchronisieren der Änderungen mit dem Back-End erstellen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-251">If you support editing, you will also need to build a system for tracking changes and synchronizing them with the backend.</span></span>

* <span data-ttu-id="9fd1e-252">Wenn Sie sicherstellen möchten, dass die Anwendung unabhängig von den Netzwerkbedingungen sofort geladen wird.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-252">If your goal is to guarantee the application loads immediately regardless of network conditions.</span></span> <span data-ttu-id="9fd1e-253">Sie müssen dann ein geeignetes Benutzererlebnis für die Back-End-API-Anforderungen implementieren, damit der Fortschritt der Anforderungen angezeigt wird und diese ein ordnungsgemäßes Verhalten aufweisen, wenn sie aufgrund der Nichtverfügbarkeit des Netzwerks fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-253">You will then need to implement a suitable user experience around backend API requests to show the progress of requests and behave gracefully when they fail due to network unavailability.</span></span>

<span data-ttu-id="9fd1e-254">Offlinefähige PWAs müssen zudem eine Reihe zusätzlicher Komplikationen bewältigen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-254">Additionally, offline-capable PWAs need to deal with a range of extra complications.</span></span> <span data-ttu-id="9fd1e-255">Entwickler sollten sich sorgfältig mit den folgenden Einschränkungen vertraut machen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-255">Developers should carefully familiarize themselves with the following caveats.</span></span>

### <a name="offline-support-only-when-published"></a><span data-ttu-id="9fd1e-256">Offlineunterstützung nur bei Veröffentlichung</span><span class="sxs-lookup"><span data-stu-id="9fd1e-256">Offline support only when published</span></span>

<span data-ttu-id="9fd1e-257">Die PWA-Vorlage von Blazor aktiviert die Offlineunterstützung nur, wenn die Anwendung veröffentlicht wird.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-257">Blazor's PWA template enables offline support only when published.</span></span> <span data-ttu-id="9fd1e-258">Der Grund hierfür ist, dass während der Entwicklung in der Regel jede Änderung sofort im Browser wiedergegeben werden soll, ohne dass ein Update im Hintergrund erfolgen muss.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-258">This is because, during development, you typically want to see each change reflected immediately in the browser, without going through a background update process.</span></span>

<span data-ttu-id="9fd1e-259">Daher reicht es beim Erstellen einer offlinefähigen Anwendung nicht aus, die Anwendung im Entwicklungsmodus zu testen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-259">Therefore when building an offline-capable application, it's not enough to test your application in development mode.</span></span> <span data-ttu-id="9fd1e-260">Sie müssen die Anwendung im veröffentlichten Zustand testen, um zu verstehen, wie sie unter unterschiedlichen Netzwerkbedingungen reagiert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-260">You must test your application in its published state to understand how it will respond to differing network conditions.</span></span>

### <a name="update-completion-after-user-navigation-away-from-app"></a><span data-ttu-id="9fd1e-261">Abschluss des Updates, nachdem der Benutzer die App verlassen hat</span><span class="sxs-lookup"><span data-stu-id="9fd1e-261">Update completion after user navigation away from app</span></span>

<span data-ttu-id="9fd1e-262">Updates werden erst abgeschlossen, wenn der Benutzer die Anwendung auf allen Registerkarten verlassen hat.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-262">Updates don't complete until the user has navigated away from your application in all tabs.</span></span> <span data-ttu-id="9fd1e-263">Wie in [Hintergrundupdates](#background-updates) erläutert, ruft der Browser die aktualisierten Service-Worker-Dateien ab und beginnt einen Updatevorgang, nachdem Sie ein Update der Anwendung bereitgestellt haben.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-263">As explained in [Background updates](#background-updates), after you deploy an update to your application, the browser will fetch the updated service worker files and begin an update process.</span></span>

<span data-ttu-id="9fd1e-264">Viele Entwickler wissen nicht, dass das Update nach seinem Abschluss **erst dann** wirksam wird, wenn die Anwendung auf allen Registerkarten vom Benutzer verlassen wurde.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-264">What surprises many developers is that, even when this update completes, it does **not** take effect until the user has navigated away in all tabs.</span></span> <span data-ttu-id="9fd1e-265">Es reicht **nicht** aus, die Registerkarte zu aktualisieren, auf der die Anwendung angezeigt wird, selbst wenn dies die einzige Registerkarte ist, auf der sie angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-265">It is **not** sufficient to refresh the tab displaying your application, even if it's the only tab displaying your application.</span></span> <span data-ttu-id="9fd1e-266">Solange die Anwendung nicht vollständig geschlossen ist, bleibt der neue Service Worker im Status „Warten auf Aktivierung“.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-266">Until your application is completely closed, the new service worker will remain in a "waiting to activate" status.</span></span> <span data-ttu-id="9fd1e-267">**Dies ist nicht auf Blazor beschränkt, sondern ein Standardverhalten von Webplattformen.**</span><span class="sxs-lookup"><span data-stu-id="9fd1e-267">**This is not specific to Blazor, but rather is a standard web platform behavior.**</span></span>

<span data-ttu-id="9fd1e-268">Dies bereitet häufig Entwicklern Probleme, die versuchen, Updates des Service Worker oder von offline zwischengespeicherten Ressourcen zu testen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-268">This commonly troubles developers who are trying to test updates to their service worker or offline cached resources.</span></span> <span data-ttu-id="9fd1e-269">Wenn Sie die Entwicklertools des Browsers einchecken, wird möglicherweise Folgendes angezeigt:</span><span class="sxs-lookup"><span data-stu-id="9fd1e-269">If you check in the browser's dev tools, you may see something like the following:</span></span>

![Bild](https://user-images.githubusercontent.com/1101362/76226394-b93f7380-6215-11ea-8572-7d52afee2dd8.png)

<span data-ttu-id="9fd1e-271">Solange die Liste der „Clients“ (d. h. Registerkarten oder Fenster, in denen die Anwendung angezeigt wird) nicht leer ist, wartet der Worker auf die Aktivierung.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-271">For as long as the list of "clients" (i.e., tabs or windows displaying your application) is nonempty, the worker will continue waiting.</span></span> <span data-ttu-id="9fd1e-272">Durch dieses Verhalten der Service Worker soll Konsistenz sichergestellt werden, sodass alle Ressourcen aus demselben atomischen Cache abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-272">The reason service workers do this is to guarantee consistency, i.e., that all resources are fetched from the same atomic cache.</span></span>

<span data-ttu-id="9fd1e-273">Wenn Sie Änderungen testen, können Sie einfach auf den im obigen Screenshot gezeigten Link „skipWaiting“ klicken und dann die Seite erneut laden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-273">When testing changes, you may find it convenient to click the "skipWaiting" link as shown in the screenshot above, then reload the page.</span></span> <span data-ttu-id="9fd1e-274">Sie können dies ggf. auch für alle Benutzer automatisieren, indem Sie den Service Worker so codieren, dass [bei einem Update die Wartephase übersprungen und der Service Worker sofort aktiviert wird](https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle#skip_the_waiting_phase).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-274">If you want, you can automate this for all users by coding your service worker to [skip the "waiting" phase and immediately activate on update](https://developers.google.com/web/fundamentals/primers/service-workers/lifecycle#skip_the_waiting_phase).</span></span> <span data-ttu-id="9fd1e-275">Hierdurch wird jedoch nicht mehr sichergestellt, dass Ressourcen immer konsistent aus derselben Cacheinstanz abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-275">However if you do this, you are giving up the guarantee that resources are always fetched consistently from the same cache instance.</span></span>

### <a name="users-may-run-any-historical-version-of-the-app"></a><span data-ttu-id="9fd1e-276">Benutzer können jede frühere Version der App ausführen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-276">Users may run any historical version of the app</span></span>

<span data-ttu-id="9fd1e-277">Webentwickler erwarten gewohnheitsmäßig, dass Benutzer nur die zuletzt bereitgestellte Version ihrer Webanwendung ausführen, da dies im herkömmlichen Webverteilungsmodell üblich ist.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-277">Web developers habitually expect that users will only run the latest deployed version of their web application, since that's normal within the traditional web distribution model.</span></span> <span data-ttu-id="9fd1e-278">Eine Offline-First-PWA ähnelt jedoch mehr einer nativen mobilen App, bei der die Benutzer nicht unbedingt die neueste Version ausführen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-278">However, an offline-first PWA is more akin to a native mobile app, where users are not necessarily running the latest version.</span></span>

<span data-ttu-id="9fd1e-279">Wie in [Hintergrundupdates](#background-updates) erläutert, **verwendet nach dem Bereitstellen des Updates einer Anwendung jeder vorhandene Benutzer mindestens noch während des nächsten Besuchs der Anwendung eine frühere Version** (da das Update im Hintergrund ausgeführt wird und erst aktiviert wird, wenn der Benutzer die Anwendung verlässt).</span><span class="sxs-lookup"><span data-stu-id="9fd1e-279">As explained in [Background updates](#background-updates), after you deploy an update to your application, **each existing user will continue to use a previous version for at least one further visit** (because the update occurs in the background and isn't activated until the user then navigates away).</span></span> <span data-ttu-id="9fd1e-280">Außerdem ist die verwendete frühere Version nicht immer die frühere Version, die Sie bereitgestellt haben. Es kann sich um eine *beliebige* frühere Version handeln, abhängig davon, wann der Benutzer zuletzt ein Update durchgeführt hat.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-280">Plus, the previous version being used isn't necessarily the previous one you deployed - it can be *any* historical version, depending on when the user last completed an update.</span></span>

<span data-ttu-id="9fd1e-281">Dies kann ein Problem darstellen, wenn die Front-End- und Back-End-Teile der Anwendung eine Vereinbarung über das Schema für API-Anforderungen erfordern.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-281">This can be an issue if the frontend and backend parts of your application require agreement about the schema for API requests.</span></span> <span data-ttu-id="9fd1e-282">Sie dürfen keine API-Schemaänderungen bereitstellen, die nicht abwärtskompatibel sind, solange Sie sich nicht vergewissert haben, dass alle Benutzer ein Upgrade durchgeführt haben. Oder Sie müssen zumindest die Verwendung inkompatibler Versionen der App durch Benutzer verhindern.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-282">You must not deploy backward-incompatible API schema changes until you can be sure that all users have upgraded, or at least block users from using incompatible older versions of the app.</span></span> <span data-ttu-id="9fd1e-283">Dasselbe gilt für eine native mobile App.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-283">This is just like a native mobile app.</span></span> <span data-ttu-id="9fd1e-284">Wenn Sie eine Breaking Change in Server-APIs bereitstellen, wird die Client-App für Personen, die noch kein Update durchgeführt haben, beschädigt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-284">If you deploy a breaking change in server APIs, the client app will be broken for people who haven't yet updated.</span></span>

<span data-ttu-id="9fd1e-285">Stellen Sie nach Möglichkeit keine Breaking Changes für die Back-End-APIs bereit.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-285">If possible, don't deploy breaking changes to your backend APIs.</span></span> <span data-ttu-id="9fd1e-286">Wenn sich dies jedoch nicht vermeiden lässt, sollten Sie mit [Standard-Service-Worker-APIs, z. B. `ServiceWorkerRegistration`](https://developer.mozilla.org/docs/Web/API/ServiceWorkerRegistration), bestimmen, ob die Anwendung auf dem neuesten Stand ist, und andernfalls ihre Verwendung verhindern.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-286">But if you must do so, consider using [standard Service Worker APIs such as `ServiceWorkerRegistration`](https://developer.mozilla.org/docs/Web/API/ServiceWorkerRegistration) to determine whether the application is up-to-date, and if not, to prevent usage.</span></span>

### <a name="interference-with-server-rendered-pages"></a><span data-ttu-id="9fd1e-287">Störungen bei auf dem Server gerenderten Seiten</span><span class="sxs-lookup"><span data-stu-id="9fd1e-287">Interference with server-rendered pages</span></span>

<span data-ttu-id="9fd1e-288">[Wie oben beschrieben](#support-server-rendered-pages), müssen Sie die Logik im Service Worker bearbeiten, wenn Sie vermeiden möchten, dass dieser für alle Navigationsanforderungen `/index.html`-Inhalte zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-288">[As described above](#support-server-rendered-pages), if you want to bypass the service worker's behavior of returning `/index.html` contents for all navigation requests, you need to edit the logic in your service worker.</span></span>

### <a name="all-service-worker-asset-manifest-contents-are-cached-by-default"></a><span data-ttu-id="9fd1e-289">Alle Inhalte des Service-Worker-Assetmanifests werden standardmäßig zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-289">All service worker asset manifest contents are cached by default</span></span>

<span data-ttu-id="9fd1e-290">[Wie oben beschrieben](#control-asset-caching), wird während des Builds die Datei *service-worker-assets.js* generiert, in der alle Ressourcen aufgelistet sind, die der Service Worker abrufen und zwischenspeichern soll.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-290">[As described above](#control-asset-caching), the file *service-worker-assets.js* is generated during build and lists all assets the service worker should fetch and cache.</span></span>

<span data-ttu-id="9fd1e-291">Da in dieser Liste standardmäßig alles enthalten ist, was an *wwwroot* ausgegeben wurde (einschließlich Inhalte, die durch externe Pakete und Projekte bereitgestellt wurden), müssen Sie darauf achten, dass Sie nicht zu viele Inhalte einfügen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-291">Since this list by default includes everything emitted to *wwwroot* (including content supplied by external packages and projects), you must be careful not to put too much content there.</span></span> <span data-ttu-id="9fd1e-292">Wenn z. B. das Verzeichnis *wwwroot* Millionen von Bildern enthält, versucht der Service Worker, sie alle abzurufen und zwischenzuspeichern. Dabei wird eine übermäßige Bandbreite beansprucht, und der Vorgang wird wahrscheinlich nicht erfolgreich abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-292">If for example your *wwwroot* directory contains millions of images, the service worker would try to fetch and cache them all, consuming excessive bandwidth and most likely not completing successfully.</span></span>

<span data-ttu-id="9fd1e-293">Sie können beliebige Logik implementieren, um zu steuern, welche Teilmenge der Inhalte des Manifests abgerufen und zwischengespeichert werden, indem Sie die Funktion `onInstall` in *service-worker.published.js* bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-293">You can implement arbitrary logic to control which subset of the manifest's contents should be fetched and cached by editing the `onInstall` function in *service-worker.published.js*.</span></span>

### <a name="interaction-with-authentication"></a><span data-ttu-id="9fd1e-294">Interaktion mit Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="9fd1e-294">Interaction with authentication</span></span>

<span data-ttu-id="9fd1e-295">Sie können die PWA-Vorlagenoption zusammen mit den Authentifizierungsoptionen verwenden.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-295">It's possible to use the PWA template option in conjunction with the authentication options.</span></span> <span data-ttu-id="9fd1e-296">Eine offlinefähige PWA kann auch die Authentifizierung unterstützen, wenn der Benutzer über Netzwerkkonnektivität verfügt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-296">An offline-capable PWA can also support authentication when the user has network connectivity.</span></span>

<span data-ttu-id="9fd1e-297">Wenn ein Benutzer jedoch über keine Netzwerkkonnektivität verfügt, kann er sich nicht authentifizieren und keine Zugriffstoken abrufen.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-297">However, when a user does not have network connectivity, they will not be able to authenticate or obtain access tokens.</span></span> <span data-ttu-id="9fd1e-298">Beim Aufruf der Anmeldungsseite wird standardmäßig die Meldung „Netzwerkfehler“ angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-298">Attempting to visit the "login" page will by default display a message saying "network error".</span></span>

<span data-ttu-id="9fd1e-299">Daher ist es Ihre Aufgabe, einen Benutzeroberflächenflow zu entwerfen, mit dem der Benutzer Aktionen offline ausführen kann, ohne sich authentifizieren oder Zugriffstoken abrufen zu müssen. Oder Sie müssen zumindest sicherstellen, dass beim Fehlschlagen der Authentifizierung oder des Zugriffstokenabrufs dies auf ordnungsgemäße Weise geschieht.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-299">As such it's your job to design a UI flow that lets the user do useful things while offline without attempting to authenticate or obtain access tokens, or at least failing in a graceful way in those cases.</span></span> <span data-ttu-id="9fd1e-300">Wenn dies in der Anwendung nicht möglich ist, sollten Sie die Offlineunterstützung nicht aktivieren.</span><span class="sxs-lookup"><span data-stu-id="9fd1e-300">If this isn't possible in your application, you might not want to enable offline support.</span></span>
